services:
  # Backend API Service
  - type: web
    name: seatrans-backend
    runtime: docker
    dockerfilePath: ./Dockerfile
    dockerContext: .
    region: singapore
    plan: free
    branch: main
    
    # Health check endpoint
    healthCheckPath: /actuator/health
    
    # Environment variables
    envVars:
      - key: SERVER_PORT
        value: 8080
      
      # Database configuration (from Render MySQL or Aiven)
      - key: DB_URL
        sync: false
      
      - key: DB_USERNAME
        sync: false
      
      - key: DB_PASSWORD
        sync: false
      
      # Cloudinary credentials (set in Render dashboard)
      - key: CLOUDINARY_CLOUD_NAME
        sync: false
      
      - key: CLOUDINARY_API_KEY
        sync: false
      
      - key: CLOUDINARY_API_SECRET
        sync: false
      
      # JWT Configuration
      - key: APP_JWT_SECRET
        generateValue: true
      
      - key: APP_JWT_EXPIRATION
        value: 86400000
      
      # Google OAuth (set in Render dashboard)
      - key: GOOGLE_CLIENT_ID
        sync: false
      
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      
      - key: GOOGLE_REDIRECT_URI
        value: https://logistic-website-h0kv.onrender.com/api/v1/auth/oauth2/callback/google
      
      # Frontend base URL for OAuth redirect
      - key: FRONTEND_BASE_URL
        value: https://logistic-website-3dyz.vercel.app
      
      # CORS origins
      - key: CORS_ALLOWED_ORIGINS
        value: https://logistic-website-3dyz.vercel.app,http://localhost:3000
      
      # Upload directories
      - key: APP_UPLOAD_DIR
        value: uploads/gallery
      
      - key: APP_UPLOAD_INQUIRY_DIR
        value: uploads/inquiry-documents
      
      - key: APP_UPLOAD_MAX_FILE_SIZE
        value: 5242880
      
      - key: APP_UPLOAD_ALLOWED_EXTENSIONS
        value: jpg,jpeg,png,webp

# Database (optional - nếu dùng Render DB thay vì Aiven)
databases:
  - name: seatrans-db
    databaseName: seatrans
    user: seatrans_user
    plan: free
    region: singapore
